# セキュリティガイドライン

## 必須セキュリティチェック

コミット前に必ず確認:
- [ ] ハードコードされたシークレットがない（APIキー、パスワード、トークン）
- [ ] 全てのユーザー入力がバリデーションされている
- [ ] SQLインジェクション対策（パラメータ化クエリ）
- [ ] XSS対策（HTMLのサニタイズ）
- [ ] CSRF保護が有効
- [ ] 認証・認可が検証済み
- [ ] 全エンドポイントにレート制限がある
- [ ] エラーメッセージが機密データを漏洩しない

## シークレット管理

```typescript
// NG: ハードコードされたシークレット
const apiKey = "sk-proj-xxxxx"

// OK: 環境変数
const apiKey = process.env.OPENAI_API_KEY

if (!apiKey) {
  throw new Error('OPENAI_API_KEYが設定されていません')
}
```

## セキュリティ対応プロトコル

セキュリティ問題が見つかった場合:
1. 直ちに作業を停止する
2. **security-reviewer** エージェントを使用する
3. CRITICALな問題を修正してから作業を続行する
4. 漏洩したシークレットをローテーションする
5. 類似の問題がないかコードベース全体をレビューする
